device=1


# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 1 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.586	SSIM: 0.8695	Threshold: 1.0	Average exits:[8.98/9]	Flops:35.74GFlops (99.840%) avg pass time: 0.81s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.99 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.558	SSIM: 0.8687	Threshold: 0.99	Average exits:[5.94/9]	Flops:25.12GFlops (70.161%) avg pass time: 0.62s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.98 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.543	SSIM: 0.8683	Threshold: 0.98	Average exits:[5.14/9]	Flops:22.34GFlops (62.401%) avg pass time: 0.59s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.97 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.528	SSIM: 0.8680	Threshold: 0.97	Average exits:[4.60/9]	Flops:20.45GFlops (57.126%) avg pass time: 0.54s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.96 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.515	SSIM: 0.8677	Threshold: 0.96	Average exits:[4.21/9]	Flops:19.08GFlops (53.303%) avg pass time: 0.48s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.92 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.473	SSIM: 0.8667	Threshold: 0.92	Average exits:[3.23/9]	Flops:15.65GFlops (43.727%) avg pass time: 0.42s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.91 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.463	SSIM: 0.8665	Threshold: 0.91	Average exits:[3.04/9]	Flops:14.99GFlops (41.873%) avg pass time: 0.39s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.9 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.453	SSIM: 0.8663	Threshold: 0.9	Average exits:[2.89/9]	Flops:14.46GFlops (40.383%) avg pass time: 0.38s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.89 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.444	SSIM: 0.8661	Threshold: 0.89	Average exits:[2.75/9]	Flops:13.98GFlops (39.039%) avg pass time: 0.36s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.88 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.435	SSIM: 0.8659	Threshold: 0.88	Average exits:[2.63/9]	Flops:13.55GFlops (37.853%) avg pass time: 0.35s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.85 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.412	SSIM: 0.8654	Threshold: 0.85	Average exits:[2.34/9]	Flops:12.54GFlops (35.036%) avg pass time: 0.34s

# python main.py --template RCAN_dytest --scale 3 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.8 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x3] PSNR: 30.375	SSIM: 0.8648	Threshold: 0.8	Average exits:[1.97/9]	Flops:11.24GFlops (31.408%) avg pass time: 0.31s

# python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 1 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x3] PSNR: 35.651	SSIM: 0.9192	Threshold: 1.0	Average exits:[8.99/9]	Flops:35.76GFlops (99.889%) avg pass time: 12.78s

# python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.9 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x3] PSNR: 35.560	SSIM: 0.9175	Threshold: 0.9	Average exits:[2.29/9]	Flops:12.36GFlops (34.526%) avg pass time: 6.94s

# python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.8 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x3] PSNR: 35.504	SSIM: 0.9168	Threshold: 0.8	Average exits:[1.44/9]	Flops:9.42GFlops (26.312%) avg pass time: 5.75s

# python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.7 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x3] PSNR: 35.470	SSIM: 0.9165	Threshold: 0.7	Average exits:[1.19/9]	Flops:8.52GFlops (23.803%) avg pass time: 5.71s

# python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.6 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x3] PSNR: 35.450	SSIM: 0.9163	Threshold: 0.6	Average exits:[1.09/9]	Flops:8.17GFlops (22.835%) avg pass time: 5.52s

python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.55 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x3] PSNR: 35.444	SSIM: 0.9162	Threshold: 0.55	Average exits:[1.06/9]	Flops:8.08GFlops (22.565%) avg pass time: 6.02s

# python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.5 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x3] PSNR: 35.439	SSIM: 0.9162	Threshold: 0.5	Average exits:[1.04/9]	Flops:8.01GFlops (22.373%) avg pass time: 4.07s

python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.45 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x3] PSNR: 35.435	SSIM: 0.9162	Threshold: 0.45	Average exits:[1.03/9]	Flops:7.96GFlops (22.234%) avg pass time: 5.77s

python main.py --template RCAN_dytest --scale 3 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.4 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x3_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x3] PSNR: 35.433	SSIM: 0.9161	Threshold: 0.4	Average exits:[1.02/9]	Flops:7.92GFlops (22.136%) avg pass time: 6.40s