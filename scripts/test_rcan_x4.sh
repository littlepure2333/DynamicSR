device=2


# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 1 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.701	SSIM: 0.8138	Threshold: 1.0	Average exits:[8.98/9]	Flops:36.71GFlops (99.827%) avg pass time: 0.46s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.99 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.684	SSIM: 0.8132	Threshold: 0.99	Average exits:[6.51/9]	Flops:28.07GFlops (76.336%) avg pass time: 0.39s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.98 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.670	SSIM: 0.8127	Threshold: 0.98	Average exits:[5.35/9]	Flops:24.01GFlops (65.292%) avg pass time: 0.38s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.97 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.658	SSIM: 0.8122	Threshold: 0.97	Average exits:[4.61/9]	Flops:21.43GFlops (58.269%) avg pass time: 0.35s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.96 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.645	SSIM: 0.8117	Threshold: 0.96	Average exits:[4.05/9]	Flops:19.50GFlops (53.026%) avg pass time: 0.32s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.9 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.581	SSIM: 0.8097	Threshold: 0.9	Average exits:[2.56/9]	Flops:14.28GFlops (38.840%) avg pass time: 0.23s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.87 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.551	SSIM: 0.8089	Threshold: 0.87	Average exits:[2.21/9]	Flops:13.06GFlops (35.524%) avg pass time: 0.23s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.86 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.541	SSIM: 0.8086	Threshold: 0.86	Average exits:[2.11/9]	Flops:12.73GFlops (34.620%) avg pass time: 0.22s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.85 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.530	SSIM: 0.8084	Threshold: 0.85	Average exits:[2.02/9]	Flops:12.39GFlops (33.703%) avg pass time: 0.21s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.84 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.520	SSIM: 0.8081	Threshold: 0.84	Average exits:[1.94/9]	Flops:12.11GFlops (32.945%) avg pass time: 0.21s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.83 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.511	SSIM: 0.8079	Threshold: 0.83	Average exits:[1.87/9]	Flops:11.86GFlops (32.260%) avg pass time: 0.21s

# python main.py --template RCAN_dytest --scale 4 --data_test DIV2K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.8 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [DIV2K x4] PSNR: 28.483	SSIM: 0.8072	Threshold: 0.8	Average exits:[1.68/9]	Flops:11.20GFlops (30.466%) avg pass time: 0.20s

# python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 1 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x4] PSNR: 33.385	SSIM: 0.8776	Threshold: 1.0	Average exits:[8.99/9]	Flops:36.74GFlops (99.916%) avg pass time: 6.78s

# python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.95 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x4] PSNR: 33.332	SSIM: 0.8761	Threshold: 0.95	Average exits:[2.87/9]	Flops:15.38GFlops (41.832%) avg pass time: 3.54s

# python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.9 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x4] PSNR: 33.284	SSIM: 0.8752	Threshold: 0.9	Average exits:[1.80/9]	Flops:11.65GFlops (31.679%) avg pass time: 2.96s

python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.88 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x4] PSNR: 33.269	SSIM: 0.8749	Threshold: 0.88	Average exits:[1.64/9]	Flops:11.07GFlops (30.106%) avg pass time: 4.42s

python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.86 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x4] PSNR: 33.255	SSIM: 0.8747	Threshold: 0.86	Average exits:[1.52/9]	Flops:10.64GFlops (28.950%) avg pass time: 4.48s

# python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.85 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x4] PSNR: 33.249	SSIM: 0.8746	Threshold: 0.85	Average exits:[1.47/9]	Flops:10.48GFlops (28.490%) avg pass time: 2.76s

python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.83 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x4] PSNR: 33.238	SSIM: 0.8744	Threshold: 0.83	Average exits:[1.38/9]	Flops:10.18GFlops (27.694%) avg pass time: 4.50s

python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
--n_parallel 500 --exit_interval 1 --exit_threshold 0.81 \
--pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# [TEST8K x4] PSNR: 33.227	SSIM: 0.8742	Threshold: 0.81	Average exits:[1.32/9]	Flops:9.95GFlops (27.059%) avg pass time: 3.39s

# python main.py --template RCAN_dytest --scale 4 --data_test TEST8K --device $device \
# --n_parallel 500 --exit_interval 1 --exit_threshold 0.8 \
# --pre_train /data/shizun/experiment/20220301_RCAN_decision_de3_x4_e300_ps192_lr0.0001_n20_i1/model/model_best.pt
# # [TEST8K x4] PSNR: 33.222	SSIM: 0.8741	Threshold: 0.8	Average exits:[1.29/9]	Flops:9.85GFlops (26.792%) avg pass time: 2.72s
